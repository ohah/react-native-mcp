# E2E CI 안정성

GitHub Actions에서 E2E 테스트가 가끔 실패하는 경우(flakiness)와 대응 방법.

---

## CI에서 하는 검사

- **Doctor**: E2E 워크플로에서 의존성 설치 후 `doctor`를 실행한다. Node ≥ 24, react-native ≥ 0.74
  미충족 시 빌드 전에 실패해 원인 파악이 빠르다.
- **Tap 타임아웃**: iOS/Android E2E job에서는 `REACT_NATIVE_MCP_TAP_TIMEOUT_MS=25000`을 사용한다.
  시뮬레이터/에뮬레이터 지연 시 10초 기본값으로는 부족할 수 있어 25초로 확대했다.

---

## 자주 나오는 실패와 대응

| 현상                           | 원인 요약                                                                                 | 대응                                                                                                                                                                                                 |
| ------------------------------ | ----------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| iOS: `Command timed out` (tap) | idb `ui tap`이 25초 안에 응답하지 않음. CI에서 시뮬레이터/idb가 간헐적으로 지연되면 발생. | tap 도구에서 타임아웃 시 1.5초 대기 후 1회 재시도. 그래도 실패하면 시뮬레이터 기기 고정([development-commands](development-commands.md#ci-e2e-시뮬레이터에뮬레이터-기기-지정)) 또는 워크플로 재실행. |
| Android: `has no measure data` | 요소는 찾았지만 measure 보충 실패(타이밍/레이아웃)                                        | 해당 스텝 직전에 `wait` 또는 `assert_visible`로 대기. 실패 시 **워크플로 재실행**으로 통과하는 경우 많음.                                                                                            |

상세 원인 분석은 [issue/ci-e2e-failure-analysis.md](issue/ci-e2e-failure-analysis.md) 참고.

---

## 재실행 권장

일시적 지연이나 측정 타이밍 이슈로 실패한 경우, GitHub Actions에서 **Re-run failed jobs** 또는 **Re-run all jobs**로
한 번 더 돌리면 통과하는 경우가 많다. 스위트 전체 재시도는 아직 CI에 넣지 않았으며, 필요 시 수동 재실행을 권장한다.
